<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · DeprecateKeywords.jl</title><script data-outdated-warner src="assets/warner.js"></script><link rel="canonical" href="https://astroautomata.com/DeprecateKeywords.jl/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>DeprecateKeywords.jl</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a></li><li><a class="tocitem" href="api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/MilesCranmer/DeprecateKeywords.jl/blob/master/docs/src/index.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="DeprecateKeywords.jl"><a class="docs-heading-anchor" href="#DeprecateKeywords.jl">DeprecateKeywords.jl</a><a id="DeprecateKeywords.jl-1"></a><a class="docs-heading-anchor-permalink" href="#DeprecateKeywords.jl" title="Permalink"></a></h1><p><a href="https://astroautomata.com/DeprecateKeywords.jl/dev/"><img src="https://img.shields.io/badge/docs-dev-blue.svg" alt="Dev"/></a> <a href="https://github.com/MilesCranmer/DeprecateKeywords.jl/actions/workflows/CI.yml?query=branch%3Amaster"><img src="https://github.com/MilesCranmer/DeprecateKeywords.jl/actions/workflows/CI.yml/badge.svg?branch=master" alt="Build Status"/></a> <a href="https://coveralls.io/github/MilesCranmer/DeprecateKeywords.jl?branch=master"><img src="https://coveralls.io/repos/github/MilesCranmer/DeprecateKeywords.jl/badge.svg?branch=master" alt="Coverage"/></a></p><p><a href="https://github.com/MilesCranmer/DeprecateKeywords.jl">DeprecateKeywords.jl</a> is tiny package (77 lines) which defines a macro for keyword deprecation. </p><p>While normally you can use <code>Base.@deprecate</code> for deprecating functions and <em>arguments</em>, because multiple dispatch does not apply to keywords, you actually need a separate macro for using at the original function signature.</p><p>For example, let&#39;s say we wish to deprecate the keyword <code>old_kw1</code> in favor of <code>new_kw1</code>, and and <code>old_kw2</code> in favor of <code>new_kw2</code>:</p><pre><code class="language-julia hljs">using DeprecateKeywords

@depkws function foo(; new_kw1=2, new_kw2=3,
                       @deprecate(old_kw1, new_kw1),
                       @deprecate(old_kw2, new_kw2))
    return new_kw1 + new_kw2
end</code></pre><p>The use of normal <code>@deprecate</code> in here is syntactic sugar to help make the signature more intuitive. The <code>@depkws</code> will simply consume the <code>@deprecate</code>s and and interpret their contents.</p><p>With this, we can use both the old and new keywords. If using the old keyword, it will automatically be passed to the new keyword, but with a deprecation warning.</p><pre><code class="language-julia hljs">julia&gt; foo(new_kw1=1, new_kw2=2)
3

julia&gt; foo(old_kw1=1, new_kw2=2)
┌ Warning: Keyword argument `old_kw1` is deprecated. Use `new_kw1` instead.
│   caller = top-level scope at REPL[5]:1
└ @ Core REPL[5]:1
3</code></pre><p>(The warning uses <code>depwarn</code>, so is only visible if one starts with <code>--depwarn=yes</code>)</p><p>Here&#39;s what this actually gets expanded to:</p><pre><code class="language-julia hljs">function foo(; old_kw2 = DeprecatedDefault, old_kw1 = DeprecatedDefault, new_kw1 = begin
                  if old_kw1 !== DeprecatedDefault
                      Base.depwarn(&quot;Keyword argument `old_kw1` is deprecated. Use `new_kw1` instead.&quot;, :foo)
                      old_kw1
                  else
                      2
                  end
              end, new_kw2 = begin
                  if old_kw2 !== DeprecatedDefault
                      Base.depwarn(&quot;Keyword argument `old_kw2` is deprecated. Use `new_kw2` instead.&quot;, :foo)
                      old_kw2
                  else
                      3
                  end
              end)
      new_kw1 + new_kw2
  end</code></pre><h3 id="Other-notes/warnings"><a class="docs-heading-anchor" href="#Other-notes/warnings">Other notes/warnings</a><a id="Other-notes/warnings-1"></a><a class="docs-heading-anchor-permalink" href="#Other-notes/warnings" title="Permalink"></a></h3><ul><li>I&#39;m not 100% sure if/when this might prevent Julia from specializing to types, or if it is different from how you would set this up manually. So just be wary of major type inference issues when passing the deprecated keywords.</li><li>This does not check whether the user passes both keyword arguments. (It might be better to use <code>kws...</code> and then pass through the old keywords within the function body. I didn&#39;t do this in my current approach so that the user could still use <code>kws...</code> in the signature if they wish.)</li><li>This uses the very nice <a href="https://github.com/FluxML/MacroTools.jl">MacroTools.jl</a> package to help make the macro generic.</li></ul><p>Contributions very much appreciated. I&#39;m also open to better syntax suggestions!</p></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="api/">API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Wednesday 28 June 2023 13:49">Wednesday 28 June 2023</span>. Using Julia version 1.9.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
